<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Financial Projection Tool</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Chart.js for visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <style>
        /* Custom scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-thumb {
            background: #9ca3af; /* gray-400 */
            border-radius: 4px;
        }
        ::-webkit-scrollbar-track {
            background: #e5e7eb; /* gray-200 */
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        'primary-blue': '#1e40af', /* Blue-800 */
                        'light-blue': '#eff6ff',  /* Blue-50 */
                        'positive-green': '#10b981', /* Emerald-500 */
                        'negative-red': '#ef4444', /* Red-500 */
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 font-sans min-h-screen p-4 md:p-8">

    <div id="app" class="max-w-7xl mx-auto space-y-8">
        <!-- Header -->
        <header class="bg-white p-6 shadow-xl rounded-2xl border border-gray-100">
            <h1 class="text-3xl font-extrabold text-primary-blue">
                Event Financial Projection Tool
            </h1>
            <p class="text-gray-500 mt-2">
                Input your event costs, expected attendance, and pricing to predict total revenue and net profit breakdown in **Indian Rupees (₹)**.
            </p>
        </header>

        <!-- Main Content Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Input and Controls (Left/Top) -->
            <div class="lg:col-span-1 space-y-6">

                <!-- Core Inputs & New Cost Breakdown -->
                <div class="bg-white p-6 shadow-xl rounded-2xl border border-gray-100">
                    <h2 class="text-xl font-semibold text-gray-700 mb-4">1. Core Event Assumptions & Costs</h2>

                    <label class="block mb-4">
                        <span class="text-sm font-medium text-gray-700">Expected Total Attendance</span>
                        <input type="number" id="inputAttendance" value="800" min="1"
                            class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-primary-blue focus:border-primary-blue shadow-inner"
                            placeholder="e.g., 800">
                    </label>

                    <h3 class="text-lg font-bold text-gray-800 border-t pt-4 mt-4">Total Event Cost Breakdown (₹)</h3>

                    <!-- New Cost Fields -->
                    <div class="space-y-3 pt-2">
                        <label class="block">
                            <span class="text-sm font-medium text-gray-600">Venue Cost (₹)</span>
                            <input type="number" id="costVenue" value="50000" min="0" class="mt-1 block w-full p-2 border border-gray-300 rounded-lg focus:ring-primary-blue focus:border-primary-blue text-sm">
                        </label>
                        <label class="block">
                            <span class="text-sm font-medium text-gray-600">Artist Cost (₹)</span>
                            <input type="number" id="costArtist" value="80000" min="0" class="mt-1 block w-full p-2 border border-gray-300 rounded-lg focus:ring-primary-blue focus:border-primary-blue text-sm">
                        </label>
                        <label class="block">
                            <span class="text-sm font-medium text-gray-600">Production Cost (₹)</span>
                            <input type="number" id="costProduction" value="40000" min="0" class="mt-1 block w-full p-2 border border-gray-300 rounded-lg focus:ring-primary-blue focus:border-primary-blue text-sm">
                        </label>
                        <label class="block">
                            <span class="text-sm font-medium text-gray-600">Man Power/Staff Cost (₹)</span>
                            <input type="number" id="costManpower" value="20000" min="0" class="mt-1 block w-full p-2 border border-gray-300 rounded-lg focus:ring-primary-blue focus:border-primary-blue text-sm">
                        </label>
                        <label class="block">
                            <span class="text-sm font-medium text-gray-600">Videographer Cost (₹)</span>
                            <input type="number" id="costVideographer" value="15000" min="0" class="mt-1 block w-full p-2 border border-gray-300 rounded-lg focus:ring-primary-blue focus:border-primary-blue text-sm">
                        </label>
                        <label class="block">
                            <span class="text-sm font-medium text-gray-600">Influencer/Marketing Cost (₹)</span>
                            <input type="number" id="costInfluencer" value="10000" min="0" class="mt-1 block w-full p-2 border border-gray-300 rounded-lg focus:ring-primary-blue focus:border-primary-blue text-sm">
                        </label>

                        <label class="block">
                            <span class="text-sm font-medium text-gray-600">Printing Cost (₹)</span>
                            <input type="number" id="costPrinting" value="5000" min="0" class="mt-1 block w-full p-2 border border-gray-300 rounded-lg focus:ring-primary-blue focus:border-primary-blue text-sm">
                        </label>

                        <label class="block">
                            <span class="text-sm font-medium text-gray-600">Bar Stock / Cost of Goods Sold (COGS) (₹)</span>
                            <input type="number" id="costBarCOGS" value="30000" min="0" class="mt-1 block w-full p-2 border border-gray-300 rounded-lg focus:ring-primary-blue focus:border-primary-blue text-sm">
                        </label>

                        <!-- NEW: Miscellaneous Cost -->
                        <label class="block">
                            <span class="text-sm font-medium text-gray-600">Miscellaneous Cost (₹)</span>
                            <input type="number" id="costMiscellaneous" value="10000" min="0" class="mt-1 block w-full p-2 border border-gray-300 rounded-lg focus:ring-primary-blue focus:border-primary-blue text-sm">
                        </label>
                    </div>

                    <!-- Calculated Total Cost Display -->
                    <div class="mt-4 p-3 bg-gray-100 rounded-lg border border-gray-300">
                        <p class="text-sm font-medium text-gray-700">Total Fixed Event Cost (Calculated):</p>
                        <p id="totalCostDisplay" class="text-xl font-bold text-red-600">₹ 0</p>
                    </div>
                </div>

                <!-- Revenue Stream Pricing -->
                <div class="bg-white p-6 shadow-xl rounded-2xl border border-gray-100">
                    <h2 class="text-xl font-semibold text-gray-700 mb-4">2. Pricing & Sales Model</h2>
                    <div class="space-y-3">
                        <!-- Tickets -->
                        <label class="block">
                            <span class="text-sm font-medium text-gray-700">Tickets (Avg Price per Ticket ₹)</span>
                            <input type="number" id="priceTickets" value="750" min="0" class="mt-1 block w-full p-2 border border-gray-300 rounded-lg focus:ring-primary-blue focus:border-primary-blue text-sm">
                        </label>
                        <!-- Bar -->
                        <label class="block">
                            <span class="text-sm font-medium text-gray-700">Bar (Avg Spend per Attendee ₹)</span>
                            <input type="number" id="priceBar" value="400" min="0" class="mt-1 block w-full p-2 border border-gray-300 rounded-lg focus:ring-primary-blue focus:border-primary-blue text-sm">
                        </label>
                        <!-- Stalls -->
                        <label class="block">
                            <span class="text-sm font-medium text-gray-700">Stalls (Total Revenue from Vendor Fees ₹)</span>
                            <input type="number" id="priceStalls" value="50000" min="0" class="mt-1 block w-full p-2 border border-gray-300 rounded-lg focus:ring-primary-blue focus:border-primary-blue text-sm">
                        </label>

                        <h3 class="text-md font-semibold text-gray-600 pt-2 border-t mt-4">VIP Sales Model</h3>

                        <!-- VIP Tables -->
                        <div class="flex gap-2">
                            <label class="block w-2/3">
                                <span class="text-sm font-medium text-gray-700">VIP Table Price (₹)</span>
                                <input type="number" id="priceVipTable" value="15000" min="0" class="mt-1 block w-full p-2 border border-gray-300 rounded-lg focus:ring-primary-blue focus:border-primary-blue text-sm">
                            </label>
                             <label class="block w-1/3">
                                <span class="text-sm font-medium text-gray-700"># Tables</span>
                                <input type="number" id="countVipTables" value="5" min="0" class="mt-1 block w-full p-2 border border-gray-300 rounded-lg focus:ring-primary-blue focus:border-primary-blue text-sm">
                            </label>
                        </div>

                        <!-- VIP Standing -->
                        <div class="flex gap-2">
                            <label class="block w-2/3">
                                <span class="text-sm font-medium text-gray-700">VIP Standing Price (₹)</span>
                                <input type="number" id="priceVipStanding" value="1200" min="0" class="mt-1 block w-full p-2 border border-gray-300 rounded-lg focus:ring-primary-blue focus:border-primary-blue text-sm">
                            </label>
                             <label class="block w-1/3">
                                <span class="text-sm font-medium text-gray-700"># Standing Guests</span>
                                <input type="number" id="countVipStanding" value="80" min="0"
                                    class="mt-1 block w-full p-2 border border-gray-300 rounded-lg focus:ring-primary-blue focus:border-primary-blue text-sm">
                            </label>
                        </div>
                    </div>
                </div>

                <button onclick="calculateProjection()"
                    class="w-full bg-green-600 text-white py-3 px-4 rounded-xl hover:bg-green-700 transition duration-200 font-bold shadow-lg">
                    Calculate Financial Projection
                </button>
            </div>

            <!-- Visualization and Stats (Right/Bottom) -->
            <div class="lg:col-span-2 space-y-8">
                <!-- Analysis/Statistics Area -->
                <div class="bg-white p-6 shadow-xl rounded-2xl border border-gray-100 order-first lg:order-last">
                    <h2 class="text-xl font-semibold text-gray-700 mb-4">3. Projected Financial Summary</h2>
                    <div id="analysisOutput" class="space-y-3">
                        <p class="text-gray-500">
                            Enter your assumptions and click "Calculate Financial Projection" to see the projected revenue, cost, and profit.
                        </p>
                    </div>
                </div>

                <!-- Visualization Area -->
                <div class="bg-white p-6 shadow-xl rounded-2xl border border-gray-100">
                    <h2 class="text-xl font-semibold text-gray-700 mb-4">4. Revenue Stream Breakdown</h2>
                    <div id="chartContainer" class="relative bg-light-blue p-4 rounded-lg h-[400px] flex items-center justify-center">
                        <canvas id="dataChart"></canvas>
                        <p id="chartPlaceholder" class="text-gray-400">Projection chart will appear here.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let chartInstance = null;
        const CHART_COLORS = [
            '#10b981', // Tickets (Green)
            '#f59e0b', // Bar (Amber)
            '#1e40af', // VIP Tables (Blue)
            '#4f46e5', // VIP Standing (Indigo)
            '#06b6d4', // Stalls (Cyan)
        ];

        // Utility function to get numeric input value
        function getInputValue(id) {
            const element = document.getElementById(id);
            // Use parseFloat to handle potential decimal inputs, default to 0 if invalid
            return parseFloat(element.value) || 0;
        }

        // Utility function to format numbers as currency (Indian Rupees)
        function formatCurrency(number) {
            return new Intl.NumberFormat('en-IN', {
                style: 'currency',
                currency: 'INR',
                minimumFractionDigits: 0, // No cents for large numbers
                maximumFractionDigits: 0
            }).format(number);
        }

        // Main function to calculate all financial projections
        function calculateProjection() {
            // --- Cost Calculations ---
            const costVenue = getInputValue('costVenue');
            const costArtist = getInputValue('costArtist');
            const costProduction = getInputValue('costProduction');
            const costManpower = getInputValue('costManpower');
            const costVideographer = getInputValue('costVideographer');
            const costInfluencer = getInputValue('costInfluencer');
            const costPrinting = getInputValue('costPrinting');
            const costBarCOGS = getInputValue('costBarCOGS');
            const costMiscellaneous = getInputValue('costMiscellaneous'); // ADDED MISCELLANEOUS COST

            const totalCost = costVenue + costArtist + costProduction + costManpower + costVideographer + costInfluencer + costPrinting + costBarCOGS + costMiscellaneous;

            // Update the calculated total cost display
            document.getElementById('totalCostDisplay').textContent = formatCurrency(totalCost);

            const attendance = getInputValue('inputAttendance');

            if (attendance <= 0) {
                alertMessage("Please enter a valid Expected Total Attendance.", 'error');
                return;
            }

            // --- Revenue Calculations ---
            const revTickets = attendance * getInputValue('priceTickets');
            const revBar = attendance * getInputValue('priceBar');

            // Stalls: Fixed total revenue from vendor fees
            const revStalls = getInputValue('priceStalls');

            // VIP Table: Price * Count
            const revVipTable = getInputValue('priceVipTable') * getInputValue('countVipTables');

            // VIP Standing: Count of guests * Price
